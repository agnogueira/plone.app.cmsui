<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/@@cmsui-overlay-container/macros/master"
      i18n:domain="plone">
<head>
<tal:js metal:fill-slot="javascript_head_slot">
<script type="text/javascript" src="++resource++plone.app.cmsui/js/dragdropreorder.js"></script>
<script type="text/javascript">
jq(function(){
  jQuery("#listing-table").ploneDnD();
});
</script>
</tal:js>
</head>

<body>

<metal:content-core fill-slot="body">
  <div id="content" tal:define="context_state context/@@plone_context_state;
				folderish python:(context_state.is_structural_folder() or context_state.is_default_page());
				batch view/batch;
				num_items context/@@cmsui-menu/itemsInFolder">
  <div id="structure-dialog">
  <div class="structure-slider">

    <nav id="portal-breadcrumbs">
      <ul>
        <li id='path-home'>
	  <span class="crumb">
	    <a class="link-parent" tal:attributes="href string:${view/@@plone_portal_state/navigation_root_url}/cmsui-structure">
	      Home
	    </a>
	  </span>
	</li>
	<li tal:repeat="crumb view/breadcrumbs">
	  <span class="crumb" tal:condition="not:repeat/crumb/end">
	    <a class="link-parent"
	       tal:attributes="href string:${crumb/absolute_url}/cmsui-structure;"
	       tal:content="crumb/Title">Item</a>
	    </span>
	  <span tal:condition="repeat/crumb/end" class="current"
                tal:content="crumb/Title">
	    Item
	  </span>
	  <span class="actions">
	    (<a href="#" class="overlayLink" tal:attributes="href string:${context/absolute_url}/edit">edit</a>, <a href="#" tal:attributes="href string:${context/absolute_url}/view">view</a>)
	  </span>
	</li>
      </ul>
    </nav>
    <form id="item-actions-menu">
      <fieldset>
	<legend>on <tal:name tal:replace="context_state/object_title" /></legend>
	<input type="button" name="move" class="first" value="move" />
	<input type="button" name="duplicate" value="duplicate" />
	<input type="button" name="rename" value="rename" />
	<input type="button" class="last" name="delete" value="delete" />
      </fieldset>
    </form>

    <form name="folderContentsForm"
          method="post"
          action="folder_object"
	  id="folder-structure-form"
          tal:attributes="action context/absolute_url">

      <input type="hidden" id="base-url" name="base-url" tal:attributes="value context/absolute_url" />

      <table class="listing"
             id="listing-table"
             summary="Content listing"
             i18n:attributes="summary summary_content_listing;"
             tal:condition="view/folderitems">
	<thead>
          <tr>
            <th colspan="3" class="nosort">
	      <a tal:attributes="href view/selectscreen_url" id="foldercontents-selectall">select all</a>
	    </th>
	    <th colspan="3" class="nosort" class="numitems">
	      <tal:folder tal:condition="python: folderish and num_items != len(batch)">
		<span tal:replace="context_state/object_title" /> contains <span tal:replace="num_items" /> items
		(<a href="#">show all</a>)
	      </tal:folder>						
	    </th>
          </tr>
          <tr tal:condition="view/show_select_all_items">
            <th colspan="6" class="nosort">
              <span tal:omit-tag="" i18n:translate="tableheading_all_items_selected">
		All <tal:block replace="python: view.batch.items_on_page" i18n:name="count"/> items on this
		page are selected. 
              </span>
              <a tal:attributes="href view/selectall_url" 
		 id="foldercontents-selectall-completebatch"
		 i18n:translate="tableheading_select_all_items">Select all 
		<tal:block replace="view/batch/size" i18n:name="count"/> items in this folder.</a>
            </th>
          </tr>
          <tr tal:condition="view/selectall">
            <th colspan="6" class="nosort">
              <span tal:omit-tag="" i18n:translate="tableheading_all_items_selected_in_folder">
		All <tal:block replace="view/batch/size" i18n:name="count"/> items in this folder
		are selected. 
              </span>
	      <a tal:attributes="href view/selectnone_url"  i18n:translate="tableheading_clear_selection"
               id="foldercontents-clearselection">Clear selection</a>
          </th>
        </tr>

        <tr>
          <th class="nosort column sorter" id="foldercontents-order-column"
              tal:condition="view/show_sort_column">
          </th>
          <th class="nosort" id="foldercontents-select-column">&nbsp;</th>
          <th class="nosort column"
              id="foldercontents-title-column">&nbsp;<tal:title i18n:translate="listingheader_title"
								>Title</tal:title>&nbsp;</th>
					<th class="nosort column"
					    id="foldercontents-creator-column">&nbsp;<tal:responsible i18n:translate="listingheader_creator"
					    >Responsible</tal:responsible>&nbsp;</th>
          <th class="nosort column"
              id="foldercontents-modified-column">&nbsp;<tal:modified i18n:translate="listingheader_modified"
								      >Modified</tal:modified>&nbsp;</th>
          <th class="nosort column"
              id="foldercontents-status-column">&nbsp;<tal:state i18n:translate="listingheader_status"
								 >State</tal:state>&nbsp;</th>
        </tr>
	</thead>
	
	<metal:block tal:condition="view/batch">
          <tbody>
            <tal:items tal:repeat="item view/batch">
	      <tr  tal:define="id item/id|item/getId;
                               title item/title|item/Title|item/title_or_id;
                               title_or_id python:title or id;"
		   tal:attributes="class item/table_row_class;
                                   id string:folder-contents-item-${id};">
		
		<td tal:condition="view/show_sort_column" class="draggable">
		  <tal:block tal:define="quoted_id item/quoted_id|python: view.quote_plus(id);">
                    <a href=""
                   title="Move item up"
                       i18n:attributes="title title_move_item_up;"
                       tal:attributes="href string:${context/absolute_url}/folder_position?position=up&amp;id=${quoted_id}">
                      &#9650;
                    </a>
                    &nbsp;
                    <a href=""
                       title="Move item down"
                       i18n:attributes="title title_move_item_down;"
                       tal:attributes="href string:${context/absolute_url}/folder_position?position=down&amp;id=${quoted_id}">
                      &#9660;
                </a>
		  </tal:block>
		</td>
		<td>
                  <input type="checkbox"
			 class="noborder"
			 name="paths:list" id="#"
			 value="#"
			 tal:attributes="value   item/path|id;
					 id      string:cb_${id};
					 checked item/checked;
					 alt     python:view.msg_select_item(item);
					 title   python:view.msg_select_item(item)" />
                  <input type="hidden" name="selected_obj_paths:list" value="#"
			 tal:attributes="value item/path|id" />
                  <label tal:content="title_or_id"
			 tal:attributes="for string:cb_${id}" 
			 class="hiddenStructure">
                    Item Title
                  </label>
		</td>
		<td>
                  <img tal:replace="structure item/icon|nothing" />
                  <a href="#" tal:attributes="href string:${item/view_url};
                                              title item/url_href_title|nothing;
                                              class string:link-child ${item/state_class|python:''} ${item/type_class|python:''};">
                    <strong tal:omit-tag="not: item/is_browser_default|nothing"
                            tal:content="title_or_id"/>
                  </a>
		  
                  <span class="state-expired"
			tal:condition="item/is_expired|nothing"
			i18n:translate="time_expired">expired</span>
		</td>
		
		<td tal:content="item/creator" />
		
		<td tal:content="item/modified"
                    tal:attributes="class item/state_class|nothing">
                  08/19/2001 03:01 AM
		</td>
		<td>
                  <span i18n:translate=""
			tal:condition="item/state_title|nothing"
			tal:content="item/state_title"
			tal:attributes="class item/state_class|nothing" />
                  <span tal:condition="not: item/state_title|nothing">&nbsp;</span>
		</td>
              </tr>
            </tal:items>
          </tbody>
          <tfoot tal:condition="not:view/within_batch_size">
            <tr tal:condition="not:view/show_all">
              <th colspan="6" class="nosort">
		<a tal:attributes="href view/show_all_url"
                   i18n:translate="label_show_all"
                   id="foldercontents-show-all">Show all items</a>
              </th>
            </tr>
            <tr tal:condition="view/show_all">
              <th colspan="6" class="nosort">
		<a tal:attributes="href string:${context/absolute_url}/@@cmsui-structure"
                   i18n:translate="label_show_batched"
                   id="foldercontents-show-batched">Show batched</a>
              </th>
            </tr>
          </tfoot>
	</metal:block>
      </table>

      <tal:buttons tal:repeat="button view/buttons">
	<input class="context"
               type="submit"
               name=""
               value=""
               i18n:attributes="value"
               tal:attributes="value button/title; name button/url; class button/cssclass|nothing" />
      </tal:buttons>
      
      <input tal:replace="structure context/@@authenticator/authenticator" />

    </form>

  </div>
  </div>
  <br style="clear: both;" />
  </div>
</metal:content-core>
</body>
</html>

